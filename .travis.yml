sudo: required
language: crystal

# Add RethinkDB
addons:
  rethinkdb: '2.3'

services:
  - docker

# Add elasticsearch 7.0.x
before_install:
  - docker run -p9300:9300 -p9200:9200 -e discovery.type=single-node -d elasticsearch:7.0.1

install:
  - shards install

# Wait for elasticsearch
before_script:
  - sleep 10

script:
  - crystal spec --no-debug
  - bin/ameba
