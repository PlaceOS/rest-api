---
openapi: 3.0.1
info:
  title: PlaceOS Rest-API
  version: 1.30.2
paths:
  /api/engine/v2/api_keys:
    get:
      summary: get all api keys
      parameters:
      - name: authority_id
        in: query
        description: Filter by authority_id
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ApiKey'
      security:
      - bearerAuth: []
    post:
      summary: Create an api key
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiKey'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
      security:
      - bearerAuth: []
  /api/engine/v2/api_keys/inspect:
    get:
      summary: Get the user token
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
  /api/engine/v2/api_keys/{id}:
    get:
      summary: get current api key
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ApiKey'
      security:
      - bearerAuth: []
    put:
      summary: Update an api key
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiKey'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
      security:
      - bearerAuth: []
    delete:
      summary: Delete an api key
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update an api key
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiKey'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
      security:
      - bearerAuth: []
  /api/engine/v2/brokers:
    get:
      summary: get all brokers
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Broker'
      security:
      - bearerAuth: []
    post:
      summary: Create a broker
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Broker'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Broker'
      security:
      - bearerAuth: []
  /api/engine/v2/brokers/{id}:
    get:
      summary: get current broker
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Broker'
      security:
      - bearerAuth: []
    put:
      summary: Update a trigger
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Broker'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Broker'
      security:
      - bearerAuth: []
    delete:
      summary: Delete a broker
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update a broker
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Broker'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Broker'
      security:
      - bearerAuth: []
  /api/engine/v2/domains:
    get:
      summary: get all domains
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Domain'
      security:
      - bearerAuth: []
    post:
      summary: Create a domain
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Domain'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
      security:
      - bearerAuth: []
  /api/engine/v2/domains/{id}:
    get:
      summary: get current domain
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
      security:
      - bearerAuth: []
    put:
      summary: Update a domain
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Domain'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
      security:
      - bearerAuth: []
    delete:
      summary: Delete a domain
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update a domain
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Domain'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
      security:
      - bearerAuth: []
  /api/engine/v2/drivers:
    get:
      summary: get drivers
      parameters:
      - name: role
        in: query
        description: filter by role
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
    post:
      summary: Create a driver
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlaceOS::Driver'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceOS::Driver'
      security:
      - bearerAuth: []
  /api/engine/v2/drivers/{id}:
    get:
      summary: get current driver
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      - name: compilation_status
        in: query
        description: include compilation status in render
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
    put:
      summary: Update a driver
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlaceOS::Driver'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceOS::Driver'
      security:
      - bearerAuth: []
    delete:
      summary: Delete a driver
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update a driver
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlaceOS::Driver'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceOS::Driver'
      security:
      - bearerAuth: []
  /api/engine/v2/drivers/{id}/compiled:
    get:
      summary: Check if the core responsible for the driver has finished compilation
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
        "404":
          description: Not Found
        "500":
          description: Internal Server Error
        "503":
          description: Service Unavailable
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
  /api/engine/v2/drivers/{id}/recompile:
    post:
      summary: Attempt to recompile driver with given ID
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
        "404":
          description: Not Found
        "408":
          description: Request Timeout
        "208":
          description: Already Reported
      security:
      - bearerAuth: []
  /api/engine/v2/edges:
    get:
      summary: get all edges
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Edge'
      security:
      - bearerAuth: []
    post:
      summary: Create an edge
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Edge'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Edge'
      security:
      - bearerAuth: []
  /api/engine/v2/edges/control:
    get:
      summary: Validate the present of the id and check the secret before routing
        to core
      parameters:
      - name: token
        in: query
        description: authenticated token
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
        "401":
          description: Unauthorized
      security:
      - bearerAuth: []
  /api/engine/v2/edges/{id}:
    get:
      summary: get current edge
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Edge'
      security:
      - bearerAuth: []
    put:
      summary: Update an edge
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Edge'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Edge'
      security:
      - bearerAuth: []
    delete:
      summary: Delete an edge
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update an edge
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Edge'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Edge'
      security:
      - bearerAuth: []
  /api/engine/v2/edges/{id}/token:
    get:
      summary: Get the token associated with the given id
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
  /api/engine/v2/triggers:
    get:
      summary: get all triggers
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Trigger'
      security:
      - bearerAuth: []
    post:
      summary: Create a trigger
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Trigger'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trigger'
      security:
      - bearerAuth: []
  /api/engine/v2/triggers/{id}:
    get:
      summary: get triggers
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      - name: instances
        in: query
        description: should instances be returned
        required: false
        schema:
          type: boolean
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
    put:
      summary: Update a trigger
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Trigger'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trigger'
      security:
      - bearerAuth: []
    delete:
      summary: Delete a trigger
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update a trigger
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Trigger'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trigger'
      security:
      - bearerAuth: []
  /api/engine/v2/triggers/{id}/instances:
    get:
      summary: Get list of instances associated wtih given id of users based on email
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
  /api/engine/v2/users:
    get:
      summary: get all users
      parameters:
      - name: authority_id
        in: query
        description: '....'
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
      security:
      - bearerAuth: []
    post:
      summary: Create a zone
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
      security:
      - bearerAuth: []
  /api/engine/v2/users/current:
    get:
      summary: Render the current user
      responses:
        "200":
          description: OK
        "401":
          description: Unauthorized
      security:
      - bearerAuth: []
  /api/engine/v2/users/groups:
    get:
      summary: Get list of groups of users based on email
      parameters:
      - name: emails
        in: query
        description: ' comma-seperated list of emails'
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
  /api/engine/v2/users/{id}:
    get:
      summary: get users
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      - name: authority_id
        in: query
        description: '....'
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    put:
      summary: Update a user
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
      security:
      - bearerAuth: []
    delete:
      summary: Delete a user
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update a user
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
      security:
      - bearerAuth: []
  /api/engine/v2/users/{id}/metadata:
    get:
      summary: Get the metadata of a user
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      - name: name
        in: query
        description: The name of the metadata
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceOS::Api::Metadata'
      security:
      - bearerAuth: []
  /api/engine/v2/zones:
    get:
      summary: get all zones
      parameters:
      - name: limit
        in: query
        description: The maximum numbers of zones to return
        required: false
        schema:
          type: integer
      - name: parent
        in: query
        description: Limit results to the children of this parent zone
        required: false
        schema:
          type: string
      - name: tags
        in: query
        description: return zones with the specified tags
        required: false
        schema:
          type: string
      - name: q
        in: query
        description: Search query term
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Zone'
        "400":
          description: Bad Request
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
    post:
      summary: Create a zone
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Zone'
        required: true
      responses:
        "201":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Zone'
      security:
      - bearerAuth: []
  /api/engine/v2/zones/{id}:
    get:
      summary: get a zone
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      - name: complete
        in: query
        description: Include trigger data in response
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Zone'
      security:
      - bearerAuth: []
    put:
      summary: Update a zone
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Zone'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Zone'
      security:
      - bearerAuth: []
    delete:
      summary: Delete a zone
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
      security:
      - bearerAuth: []
    patch:
      summary: Update a zone
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Zone'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Zone'
      security:
      - bearerAuth: []
  /api/engine/v2/zones/{id}/exec/{module_slug}/{method}:
    post:
      summary: Execute a method on a module across all systems in a Zone
      parameters:
      - name: method
        in: path
        required: true
        schema:
          type: string
        example: method
      - name: module_slug
        in: path
        required: true
        schema:
          type: string
        example: module_slug
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            text/yaml:
              schema: {}
      security:
      - bearerAuth: []
  /api/engine/v2/zones/{id}/metadata:
    get:
      summary: Get the metadata of a zone
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      - name: name
        in: query
        description: The name of the metadata
        required: false
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceOS::Api::Metadata'
      security:
      - bearerAuth: []
  /api/engine/v2/zones/{id}/triggers:
    get:
      summary: get the triggers attached to current zone
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
        example: id
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Trigger'
      security:
      - bearerAuth: []
components:
  schemas:
    Zone:
      required:
      - name
      - description
      type: object
      properties:
        name:
          type: string
          example: Zone 539
        description:
          type: string
          example: This zone has space for 3697 people
    Metadata:
      required:
      - name
      - description
      - details
      type: object
      properties:
        name:
          type: string
          example: Orange Metadata
        description:
          type: string
          example: Includes size of orange & more...
        details:
          type: object
          additionalProperties: true
    User:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          example: Robert
    ApiKey:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          example: Robert
    Edge:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          example: Robert
    Driver:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          example: Robert
    Domain:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          example: Robert
    Broker:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          example: Robert
    Trigger:
      required:
      - name
      - description
      type: object
      properties:
        name:
          type: string
          example: Trigger 3
        description:
          type: string
          example: Trigger for zone 34
  responses: {}
  parameters: {}
  examples: {}
  requestBodies: {}
  headers: {}
  securitySchemes: {}
  links: {}
  callbacks: {}
